From 777d8c9cb33e4b3ef558e19e3b88c1e3c579b484 Mon Sep 17 00:00:00 2001
From: Clinton Sprain <clinton.sprain@gmail.com>
Date: Thu, 3 Mar 2016 07:50:43 -0600
Subject: [PATCH 1/1] Use EC device name instead of ID to identify whether lightbar attributes should appear.

---
 build/linux/drivers/platform/chrome/cros_ec_lightbar.c | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)

diff --git a/build/linux/drivers/platform/chrome/cros_ec_lightbar.c b/build/linux/drivers/platform/chrome/cros_ec_lightbar.c
index ff76405..b6356b3 100644
--- linux-patched/drivers/platform/chrome/cros_ec_lightbar.c
+++ b/build/linux/drivers/platform/chrome/cros_ec_lightbar.c
@@ -414,7 +414,12 @@ static umode_t cros_ec_lightbar_attrs_are_visible(struct kobject *kobj,
 					      struct cros_ec_dev, class_dev);
 	struct platform_device *pdev = container_of(ec->dev,
 						   struct platform_device, dev);
-	if (pdev->id != 0)
+	struct cros_ec_platform *pdata = pdev->dev.platform_data;
+	int is_cros_ec;
+
+	is_cros_ec = strcmp(pdata->ec_name, CROS_EC_DEV_NAME);
+
+	if (is_cros_ec != 0)
 		return 0;
 
 	/* Only instantiate this stuff if the EC has a lightbar */
-- 
2.5.0

